<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');ul.lst-kix_d2u5foajzy9c-5{list-style-type:none}ul.lst-kix_d2u5foajzy9c-4{list-style-type:none}ul.lst-kix_d2u5foajzy9c-7{list-style-type:none}ul.lst-kix_d2u5foajzy9c-6{list-style-type:none}.lst-kix_d2u5foajzy9c-8>li:before{content:"\0025a0  "}ul.lst-kix_d2u5foajzy9c-1{list-style-type:none}.lst-kix_d2u5foajzy9c-6>li:before{content:"\0025cf  "}ul.lst-kix_d2u5foajzy9c-0{list-style-type:none}ul.lst-kix_d2u5foajzy9c-3{list-style-type:none}.lst-kix_d2u5foajzy9c-5>li:before{content:"\0025a0  "}ul.lst-kix_d2u5foajzy9c-2{list-style-type:none}.lst-kix_d2u5foajzy9c-4>li:before{content:"\0025cb  "}.lst-kix_d2u5foajzy9c-3>li:before{content:"\0025cf  "}.lst-kix_d2u5foajzy9c-0>li:before{content:"\0025cf  "}.lst-kix_d2u5foajzy9c-2>li:before{content:"\0025a0  "}.lst-kix_d2u5foajzy9c-1>li:before{content:"\0025cb  "}ul.lst-kix_d2u5foajzy9c-8{list-style-type:none}.lst-kix_d2u5foajzy9c-7>li:before{content:"\0025cb  "}ol{margin:0;padding:0}table td,table th{padding:0}.c18{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#282c34;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c13{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#2b2b2b;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c21{background-color:#282c34;font-family:"Consolas";font-style:italic;color:#5c6370;font-weight:400}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left;height:11pt}.c4{border-spacing:0;border-collapse:collapse;margin-right:auto}.c15{background-color:#282c34;font-family:"Consolas";color:#61aeee;font-weight:400}.c2{background-color:#282c34;font-family:"Consolas";color:#abb2bf;font-weight:400}.c0{background-color:#2b2b2b;font-family:"Consolas";color:#cb7832;font-weight:400}.c9{background-color:#282c34;font-family:"Consolas";color:#e6c07b;font-weight:400}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c6{background-color:#282c34;font-family:"Consolas";color:#c678dd;font-weight:400}.c17{background-color:#2b2b2b;font-family:"Consolas";color:#b9b9b9;font-weight:400}.c7{background-color:#2b2b2b;font-family:"Consolas";color:#7f7f7f;font-weight:400}.c1{background-color:#2b2b2b;font-family:"Consolas";color:#bababa;font-weight:400}.c10{margin-left:36pt;padding-left:0pt;orphans:2;widows:2}.c12{background-color:#2b2b2b;font-family:"Consolas";color:#6a8759;font-weight:400}.c16{background-color:#2b2b2b;font-family:"Consolas";color:#6896ba;font-weight:400}.c11{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c19{orphans:2;widows:2}.c20{padding:0;margin:0}.c14{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c11"><p class="c3 c19"><span class="c5"></span></p><ul class="c20 lst-kix_d2u5foajzy9c-0 start"><li class="c8 c10"><span class="c5">Py4J enables Python programs running in a Python interpreter to dynamically access Java objects in a Java Virtual Machine. Methods are called as if the Java objects resided in the Python interpreter and Java collections can be accessed through standard Python collection methods. </span></li><li class="c8 c10"><span class="c5">Py4J also enables Java programs to call back Python objects. (&#38617;&#21521;&#30340;)</span></li><li class="c8 c10"><span class="c5">Note that the Java program must be started before executing the Python code above. In other words, the Py4J does not start a JVM.</span></li></ul><p class="c3"><span class="c5"></span></p><p class="c3"><span class="c5"></span></p><a id="t.03145596ffabcca6a09515a9751f7f4b7fe5ba13"></a><a id="t.0"></a><table class="c4"><tbody><tr class="c14"><td class="c18" colspan="1" rowspan="1"><p class="c8"><span class="c6">import</span><span class="c2">&nbsp;py4j.GatewayServer;<br><br></span><span class="c6">public</span><span class="c2">&nbsp;</span><span class="c6">class</span><span class="c2">&nbsp;</span><span class="c9">AdditionApplication</span><span class="c2">&nbsp;{<br><br> &nbsp;</span><span class="c6">public</span><span class="c2">&nbsp;</span><span class="c6">int</span><span class="c2">&nbsp;</span><span class="c15">addition</span><span class="c2">(</span><span class="c6">int</span><span class="c2">&nbsp;first, </span><span class="c6">int</span><span class="c2">&nbsp;second) {<br> &nbsp; &nbsp;</span><span class="c6">return</span><span class="c2">&nbsp;first + second;<br> &nbsp;}<br><br> &nbsp;</span><span class="c6">public</span><span class="c2">&nbsp;</span><span class="c6">static</span><span class="c2">&nbsp;</span><span class="c6">void</span><span class="c2">&nbsp;</span><span class="c15">main</span><span class="c2">(String[] args) {<br> &nbsp; &nbsp;AdditionApplication app = </span><span class="c6">new</span><span class="c2">&nbsp;AdditionApplication();<br> &nbsp; &nbsp;</span><span class="c21">//&#22312;Java&#31471;&#35201;instantiate server</span><span class="c2"><br> &nbsp; &nbsp;GatewayServer server = </span><span class="c6">new</span><span class="c2">&nbsp;GatewayServer(app);<br> &nbsp; &nbsp;server.start();<br> &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c3"><span class="c5"></span></p><p class="c3"><span class="c5"></span></p><a id="t.b8ad6b339d5d7e66fdd84264a0072460f68e0614"></a><a id="t.1"></a><table class="c4"><tbody><tr class="c14"><td class="c13" colspan="1" rowspan="1"><p class="c8"><span class="c0">from</span><span class="c1">&nbsp;py4j.java_gateway </span><span class="c0">import</span><span class="c1">&nbsp;JavaGateway<br><br></span><span class="c7"># connect to JVM</span><span class="c1"><br>gateway = JavaGateway()<br><br></span><span class="c7"># &#30452;&#25509;&#20351;&#29992;Java class, method</span><span class="c1"><br>random = gateway.jvm.java.util.Random()<br>number1 = random.nextInt(</span><span class="c16">10</span><span class="c1">)<br><br></span><span class="c7"># &#30452;&#25509;&#20351;&#29992;&#33258;&#24049;&#23450;&#32681;&#30340;java class</span><span class="c1"><br>addition_app = gateway.entry_point<br>value = addition_app.addition(number1, number2)</span></p></td></tr></tbody></table><p class="c3"><span class="c5"></span></p><p class="c3"><span class="c5"></span></p><p class="c3"><span class="c5"></span></p><a id="t.7681422c9b1cf99d2d95fb3f7969f20880844775"></a><a id="t.2"></a><table class="c4"><tbody><tr class="c14"><td class="c13" colspan="1" rowspan="1"><p class="c8"><span class="c7"># apache/spark/blob/master/python/pyspark/java_gateway.py</span><span class="c1"><br>script = </span><span class="c12">&quot;./bin/spark-submit.cmd&quot;</span><span class="c1">&nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;on_windows </span><span class="c0">else</span><span class="c1">&nbsp;</span><span class="c12">&quot;./bin/spark-submit&quot;</span><span class="c1"><br>command = [os.path.join(SPARK_HOME, script)]<br><br>command = command + shlex.split(submit_args)<br>...<br>proc = Popen(command, **popen_kwargs)<br>...<br>gateway = JavaGateway(<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gateway_parameters=GatewayParameters(<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;port=gateway_port,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth_token=gateway_secret,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auto_convert=</span><span class="c0">True</span><span class="c1">))<br><br>gateway.proc = proc</span></p></td></tr></tbody></table><p class="c3"><span class="c5"></span></p><p class="c3"><span class="c5"></span></p><a id="t.af473057efabb7162b6ab9dcea40436421c03b06"></a><a id="t.3"></a><table class="c4"><tbody><tr class="c14"><td class="c13" colspan="1" rowspan="1"><p class="c8"><span class="c7"># spark/python/pyspark/context.py</span><span class="c1"><br></span><span class="c0">from</span><span class="c1">&nbsp;pyspark.java_gateway </span><span class="c0">import</span><span class="c1">&nbsp;launch_gateway, local_connect_and_auth<br><br>...<br>SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)<br>...<br><br></span><span class="c7">@classmethod</span><span class="c1"><br></span><span class="c0">def</span><span class="c1">&nbsp;_ensure_initialized</span><span class="c17">(cls, instance=None, gateway=None, conf=None)</span><span class="c1">:<br> &nbsp; &nbsp;</span><span class="c12">&quot;&quot;&quot;<br> &nbsp; &nbsp;Checks whether a SparkContext is initialized or not.<br> &nbsp; &nbsp;Throws error if a SparkContext is already running.<br> &nbsp; &nbsp;&quot;&quot;&quot;</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c0">with</span><span class="c1">&nbsp;SparkContext._lock:<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;</span><span class="c0">not</span><span class="c1">&nbsp;SparkContext._gateway:<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SparkContext._gateway = gateway </span><span class="c0">or</span><span class="c1">&nbsp;launch_gateway(conf)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SparkContext._jvm = SparkContext._gateway.jvm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p></td></tr></tbody></table><p class="c3"><span class="c5"></span></p></body></html>